Command Line Tutorial
=====================

Installation
------------

Copy my project to where ever you want. You will need to have installed the Java JRE.
If you use PrimerSeq from source files you will need to do a little more setup.
First, I recommend using python2.7. Next, you will need to install additional python packages:

.. code-block:: console

   $ pip install pygr
   $ pip install numpy
   $ pip install matplotlib
   $ wget http://networkx.lanl.gov/download/networkx/networkx-1.7.tar.gz
   $ tar xvzf networkx-1.7.tar.gz
   $ cd networkx-1.7
   $ python setup.py install

Run
---

To run the program you will need several files:

* FASTA
* GTF
* single or multiple SAM/BAM file(s) (name with .sorted.bam extension if sorted)

You can checkout the command line options by typing **python primer.py --help**:

.. code-block:: console

   usage: primer.py [-h] -g GTF [--no-gene-id] -f FASTA -r RNASEQ -t TARGET
                    (--annotaton | --both) [--psi PSI]
                    [--read-threshold READ_THRESHOLD] [--keep-temp]
                    [-m MIN_JCT_COUNT] [-a ANCHOR_LENGTH] -o OUTPUT

   Command line interface for designing primers

   optional arguments:
     -h, --help            show this help message and exit
     -g GTF                gtf file that defines the possible exons in a gene
     --no-gene-id          Use this flag if your gtf does not have a valid
                           gene_id
     -f FASTA              path to fasta file
     -r RNASEQ             path to SAM/BAM file(s) ("," delimited)
     -t TARGET             path to txt file with <strand><chr>:<start>-<end> for
                           each target on separate lines.
     --annotaton           only use junctions supported from annotation
     --both                use junctions from both RNA-Seq and annotation
     --psi PSI             Define inclusion level sufficient to define
                           constitutive exon. Valid: 0<psi<1.
     --read-threshold READ_THRESHOLD
                           Define the minimum number of read support necessary to
                           call a junction from RNA-Seq
     --keep-temp           Keep temporary files in your tmp directory
     -m MIN_JCT_COUNT, --min-jct-count MIN_JCT_COUNT
                           Assign junctions that are known from annotation at
                           least MIN_JCT_COUNT number of reads
     -a ANCHOR_LENGTH, --anchor-length ANCHOR_LENGTH
                           Set the minimum number of bases a junction read must
                           span on both sides of the junction
     -o OUTPUT             Output directory

Example
-------

The following command has paths where you should specify your own data.

.. code-block:: console
   
   python primer.py -g example/example.chr18.gtf -f example/chr18.fa -r example/chr18_9546792_9614600.sorted.bam -t example.input.txt --both --psi .95 -o output.txt

.. note::
   
   The gtf file should be sorted. Use gtf.py to sort your GTF (type **python gtf.py --help** to learn more). You can obtain pre-sorted GTFs from
   `here <http://sourceforge.net/projects/primerseq/files/GTF/>`_.

To define your own targets (**-t** option) create a two column tab-separated file with no header. The provided example in example.input.txt looks like the following:

== =========================
ID Target
== =========================
1  -chr18:9562919-9563044
== =========================

Although there is only one target exon, you may specify additional targets by following the same column format.
